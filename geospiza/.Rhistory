plot(cars)
library(plyr)
source('~/Dropbox/FUN.add.alpha.R', chdir = TRUE)
data = read.delim('~/Dropbox/wing_spurs/wing.spur.data.txt',stringsAsFactors=T)
tmp = read.delim('~/Dropbox/wing_spurs/wing.spur.key_subobscine.txt',stringsAsFactors=F)
sp.list = tmp[tmp[,2] %in% T,'tip']
taxkey = read.csv('~/Dropbox/wing_spurs/suboscine_taxonomy_key.csv',stringsAsFactors=F)
species = unique(mapvalues(sp.list,taxkey[,'tipnamecodes'],taxkey[,'phy.species']))
species = gsub(' ','_',species)
unique(data$Name) %in% species[grep('Myiarchus',species)]
clem = read.csv('~/Dropbox/Clements/Clements-Checklist-v2018-August-2018.csv',stringsAsFactors=F)
species = clem[clem$scientific.name %in% gsub('_',' ',unique(data$Name)),c('scientific.name','sort.v2018')]
species[,1] = gsub(' ','_',species[,1])
data$adj.spur.length = data$spur.length / data$w.l
anova(lm(adj.spur.length ~ Name*Sex, data=data)) #Analysis of Variance
################################################################################
##	Plot all species raw spur.lengths
####################################################################################
nrow(species)
N = nrow(species)
52/13 = 4
ncol=13
nrow=4
fac = 1.5 #scale factor
axis.width = .5
dev.new(width=(ncol+axis.width)/fac,height=(2*nrow)/fac)
mat = matrix(c(1:52), nrow=nrow, ncol=ncol, byrow=T)
# nf = layout(mat=mat,heights=c(6,6),widths=c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1))
mat = cbind(52+c(1,2,3,4),mat)
nf = layout(mat=mat,heights=rep(2,nrow)/fac,widths=c(axis.width,rep(1,ncol))/fac)
#layout.show(n=56)
ylim = c(-100,1500)
i = 2
for(i in 1:nrow(species)){
#for(i in 1:7){
spp = species[i,1]
tmp = data[data$Name %in% spp & !(data$Sex %in% 'Unknown'), ]
tmp$Sex = factor(tmp$Sex,levels=c('Female','Male'))
if(nrow(tmp) >= 5){
fit = anova(lm(spur.length ~ Sex, data=tmp)) #Analysis of Variance
p = fit[1,5]
}else{ p = 1}
par(mar=c(3,1,0,1)/fac)
boxplot(spur.length ~ Sex, data = tmp, col=c('transparent', 'transparent'),ylim=ylim,frame.plot=F,axes=FALSE,outline=F,border='transparent')
abline(h=c(0),lty=1,lwd=1,col='grey75')
abline(h=c(500,1000,1500),lty=3,lwd=1,col='grey50')
boxplot(spur.length ~ Sex, data = tmp, col=c('transparent', 'grey50'),ylim=ylim, frame.plot=F,axes=FALSE,add=T,lwd=.5,cex=.5/fac)
points(tmp$Sex, tmp$spur.length,col='black',bg='black',pch=21,lwd=.5,cex=.5/fac)
tab = table(tmp$Sex)
Nmale = table(tmp$Sex)['Male']
Nfemale = table(tmp$Sex)['Female']
text(.8,-100,"\\VE", vfont=c("sans serif","bold"),col='black',bg='black',pch=21,lwd=.5,cex=1.5/fac)
text(1.2,-100,paste0("(", Nfemale,')'),col='black',bg='black',pch=21,lwd=.5,cex=.75)
text(1.8,-100,"\\MA", vfont=c("sans serif","bold"),col='black',bg='black',pch=21,lwd=.5,cex=1.5/fac)
text(2.2,-100,paste0("(", Nmale,')'),col='black',bg='black',pch=21,lwd=.5,cex=.75)
if(p <= 0.05) text(1.5,100,'*',cex=2/fac)
if(i == 1){	}else if(ge != strsplit(spp,'_')[[1]][1]){
#axis(2, at=c(-1000,2000), labels=F,tick=F,lty=1,lwd=1,line=1,col='black')
axis(2, at=c(-5000,1500),label=F,col="black",line=.7,tick=T,lwd=2,lwd.ticks=0)
}
ge = strsplit(spp,'_')[[1]][1]
sp = strsplit(spp,'_')[[1]][2]
axis(1, at=1.5, labels= ge,font=3,las=1,tick=F,cex.axis=1/fac,	line=-1)
axis(1, at=1.5, labels= sp,font=3,las=1,tick=F,cex.axis=1/fac,	line=-.25)
}
#plot 52
par(mar=c(3,2,0,0))
plot(0, type="n", xlab="", ylab="", xlim=c(0, 10), ylim=c(-50, 1500),frame=F,axes=F)
i = 1
for(i in 1:nrow){
par(mar=c(3,2,0,0)/fac)
plot(0, type="n", xlab="", ylab="", xlim=c(0, 10), ylim=ylim,frame=F,axes=F)
axis(2, at=seq(0,1500,100), labels=c(0,'','','','',500,'','','','',1000,'','','','',1500),las=1,line=-1.5,lwd=1/fac,cex.axis=1/fac,hadj=.6)
mtext('Spur Length (Î¼m)',2,line=.25,cex=.5)
}
1-1
#load packages
library(mclust)
library(mvtnorm)
library(ellipse)
library(clustvarsel)
library(dplyr)
library(ggplot2)
library(RColorBrewer)
#read the morphological data and examine the resulting data frame
data <- read.table("data.csv", header=T, sep=",")
#explore
p <- data %>%
ggplot( aes(x=Island, y=Bdepth, fill=Island)) +
geom_violin() +
xlab("Island") +
theme(legend.position="none") +
xlab("")
dev.new(width=8,height=5)
#load packages
library(mclust)
library(mvtnorm)
library(ellipse)
library(clustvarsel)
library(dplyr)
library(ggplot2)
library(RColorBrewer)
#load packages
library(mclust)
library(mvtnorm)
library(ellipse)
library(clustvarsel)
library(dplyr)
library(ggplot2)
library(RColorBrewer)
setwd('~/Dropbox/SBE/SBE.in.silico/geospiza/')
#read the morphological data and examine the resulting data frame
data <- read.table("data.csv", header=T, sep=",")
data
p <- data %>%
ggplot( aes(x=Island, y=Bdepth, fill=Island)) +
geom_violin() +
xlab("Island") +
theme(legend.position="none") +
xlab("")
p
